d <- d4 %>% 
  separate(exp_nost, c("group", "tmp")) %>% 
  mutate(scapegoat = recode(group, #scapegoat == 1
                            `A1` = 0,
                            `A2` = 1,
                            `A3` = 0,
                            `A4` = 1,
                            `B1` = 0,
                            `B2` = 1,
                            `B3` = 0,
                            `B4` = 1),
         nostalgia = recode(group,#nostalgia == 1
                            `A1` = 0,
                            `A2` = 0,
                            `A3` = 1,
                            `A4` = 1,
                            `B1` = 0,
                            `B2` = 0,
                            `B3` = 1,
                            `B4` = 1),
         ideology = recode(group,#right == 1
                           `A1` = 0,
                           `A2` = 0,
                           `A3` = 0,
                           `A4` = 0,
                           `B1` = 1,
                           `B2` = 1,
                           `B3` = 1,
                           `B4` = 1),
         pop_vote = A2b,
         pop_vote = na_if(pop_vote, "Don't know"),
         pop_vote = na_if(pop_vote, "Not eligible"),
         pop_vote = na_if(pop_vote, "Other party"),
         pop_vote = na_if(pop_vote, "Won't vote"),
         pop_vote = recode(pop_vote,
                           `BBB` = 1,
                           `FvD` = 1,
                           `BVNL` = 1,
                           `JA21` = 1,
                           `PVV` = 1,
                           `SP` = 1,
                           .default = 0),
         scapegoat_support_self = recode(H21_1,
                                         `No nostalgia + scapegoat` = 1,
                                         `Nostalgia + scapegoat` = 1,
                                         .default = 0),
         nostalgia_support_self = recode(H21_1,
                                         `Nostalgia` = 1,
                                         `Nostalgia + scapegoat` = 1,
                                         .default = 0),
         scapegoat_support_self = recode(H21_1,
                                         `No nostalgia + scapegoat` = 1,
                                         `Nostalgia + scapegoat` = 1,
                                         .default = 0),
         nostalgia_support_dutch = recode(H21_2,
                                          `Nostalgia` = 1,
                                          `Nostalgia + scapegoat` = 1,
                                          .default = 0),
         scapegoat_support_dutch = recode(H21_2,
                                          `No nostalgia + scapegoat` = 1,
                                          `Nostalgia + scapegoat` = 1,
                                          .default = 0),
         nostalgia_support_ingroup = recode(H21_1,
                                            `Nostalgia` = 1,
                                            `Nostalgia + scapegoat` = 1,
                                            .default = 0),
         scapegoat_support_ingroup = recode(H21_2,
                                            `No nostalgia + scapegoat` = 1,
                                            `Nostalgia + scapegoat` = 1,
                                            .default = 0),
         E2_2_d = recode(E2_2,
                       `consersative` = 1,
                       `very conservative` = 1,
                       `center` = 1,
                       .default = 0),
         right_vote = A2b,
         right_vote = na_if(right_vote, "Don't know"),
         right_vote = na_if(right_vote, "Not eligible"),
         right_vote = na_if(right_vote, "Other party"),
         right_vote = na_if(right_vote, "Won't vote"),
         right_vote = recode(right_vote,
                             `BBB` = 1,
                             `BVNL` = 1,
                             `JA21` = 1,
                             `PVV` = 1,
                             `CDA` = 1,
                             `D66` = 1,
                             `SGP` = 1,
                             `VVD`= 1,
                             .default = 0)) %>% 
  dplyr::select(-tmp) %>% 
  drop_na(pop_vote)
